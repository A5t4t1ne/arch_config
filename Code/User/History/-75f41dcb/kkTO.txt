cmake_minimum_required(VERSION 3.0.0)
project(pw_manager VERSION 0.1.0)

# libsodium
find_package(PkgConfig REQUIRED)
pkg_check_modules(LIBSODIUM REQUIRED libsodium)
include_directories(${LIBSODIUM_INCLUDE_DIRS})

set(SOURCE_DIR ${CMAKE_CURRENT_SOURCE_DIR}/src)
add_executable(pw_manager
  ${SOURCE_DIR}/main.c
  ${SOURCE_DIR}/crypto.c
  ${SOURCE_DIR}/files.c
  ${SOURCE_DIR}/password.c
)
target_include_directories(pw_manager PUBLIC include)

# use static openssl library
# set(OPENSSL_USE_STATIC_LIBS TRUE)
# Find OpenSSL
find_package(OpenSSL REQUIRED)
if(OPENSSL_FOUND)
  include_directories(${OPENSSL_INCLUDE_DIR})
  target_link_libraries(pw_manager ${OPENSSL_LIBRARIES})
else()
  message(FATAL_ERROR "OpenSSL not found")
endif()
target_link_libraries(pw_manager libsodium.a ${LIBSODIUM_DIR}/lib/libsodium.a ${CMAKE_DL_LIBS})

message(STATUS "OpenSSL include dir: ${OPENSSL_INCLUDE_DIR}")
message(STATUS "OpenSSL found: ${OPENSSL_FOUND}")
message(STATUS "OpenSSL libraries: ${OPENSSL_LIBRARIES}")

